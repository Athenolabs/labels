{"version":3,"file":"labels.min.js","sources":["../../../../apps/labels/labels/public/js/labels.js"],"sourcesContent":["frappe.ui.form.on(\"Production Plan\", {\n    refresh: function (frm) {\n        frm.add_custom_button(__('GENERAR ETIQUETA'), function () {\n            frappe.call({\n                method: \"labels.api_labels.child_table_to_csv\",\n                args: {\n                    dict_data: cur_frm.doc.po_items\n                },\n                callback: function (r) {\n                    window.open(r.message);\n                }\n            });\n        }).addClass(\"btn-primary\");\n\n        frm.add_custom_button(__('GENERAR STICKER'), function () {\n            frappe.call({\n                method: \"jsonshare.utils.obtener_usuarios\",\n                callback: function (response) {\n                    // Crea un Modal(dialogo), en las opciones del campo\n                    // user_share se asigna el listado de usarios retornados\n                    let dialog = new frappe.ui.Dialog({\n                        title: __('Compartir Item'),\n                        fields: [\n                            {\n                                fieldtype: 'Select',\n                                fieldname: 'user_share',\n                                label: __('Seleccione Usuario'),\n                                reqd: true,\n                                options: response.message,\n                                description: __('Seleccione el host/usuario con quien quiera compartir el Item')\n                            },\n                            {\n                                fieldtype: 'Button',\n                                fieldname: 'btn_share',\n                                label: __('Compartir'),\n                                options: '',\n                                description: __(''),\n                            }\n                        ]\n                    });\n\n                    // Muestra el dialogo\n                    dialog.show();\n\n                    // Agrega un event lister al boton compartir del dialogo\n                    dialog.fields_dict.btn_share.$wrapper.on('click', function (e) {\n                        console.log(dialog.fields_dict.user_share.value);\n                        frappe.call({\n                            method: \"jsonshare.api.crud\",\n                            args: {\n                                item: codigo,\n                                usuario: dialog.fields_dict.user_share.value,\n                                doctype: doctype\n                            },\n                            callback: function () {\n                                // frm.reload_doc();\n                            }\n                        });\n                    });\n                }\n            });\n\n        }).addClass(\"btn-success\");\n\n        cur_frm.page.add_action_icon(__(\"fa fa-sticky-note\"), function () {\n\n            let dialog = new frappe.ui.Dialog({\n                title: __('Generar Stickers'),\n                fields: [\n                    {\n                        fieldtype: 'Select',\n                        fieldname: 'sticker_type',\n                        label: __('Estilo de sticker'),\n                        reqd: true,\n                        options: [\n                            \"Sticker sin fechas\",\n                            \"Sticker con fecha de cosecha\",\n                            \"Sticker con fecha de vencimiento\"\n                        ],\n                        description: __('Seleccione el estilo de sticker que desee generar')\n                    },\n                    {\n                        fieldtype: 'Button',\n                        fieldname: 'btn_generar',\n                        label: __('Generar Stickers'),\n                        options: '',\n                        description: __(''),\n                    }\n                ]\n            });\n\n            // Muestra el dialogo\n            dialog.show();\n\n            // Agrega un event lister al boton compartir del dialogo\n            dialog.fields_dict.btn_generar.$wrapper.on('click', function (e) {\n                console.log(dialog.fields_dict.sticker_type.value);\n                // frappe.call({\n                //     method: \"jsonshare.api.crud\",\n                //     args: {\n                //         item: codigo,\n                //         usuario: dialog.fields_dict.user_share.value,\n                //         doctype: doctype\n                //     },\n                //     callback: function () {\n                //         // frm.reload_doc();\n                //     }\n                // });\n            });\n        });\n    }\n});\n"],"names":["frappe","ui","form","on","refresh","frm","add_custom_button","__","call","method","args","dict_data","cur_frm","doc","po_items","callback","r","window","open","message","addClass","response","let","dialog","Dialog","title","fields","fieldtype","fieldname","label","reqd","options","description","show","fields_dict","btn_share","$wrapper","e","console","log","user_share","value","item","codigo","usuario","doctype","page","add_action_icon","btn_generar","sticker_type"],"mappings":"yBAAAA,OAAOC,GAAGC,KAAKC,GAAG,mBACdC,QAAS,SAAUC,GACfA,EAAIC,kBAAkBC,GAAG,oBAAqB,WAC1CP,OAAOQ,MACHC,OAAQ,uCACRC,MACIC,UAAWC,QAAQC,IAAIC,UAE3BC,SAAU,SAAUC,GAChBC,OAAOC,KAAKF,EAAEG,cAGvBC,SAAS,eAEZf,EAAIC,kBAAkBC,GAAG,mBAAoB,WACzCP,OAAOQ,MACHC,OAAQ,mCACRM,SAAU,SAAUM,GAGhBC,IAAIC,EAAS,IAAIvB,OAAOC,GAAGuB,QACvBC,MAAOlB,GAAG,kBACVmB,SAEQC,UAAW,SACXC,UAAW,aACXC,MAAOtB,GAAG,sBACVuB,MAAM,EACNC,QAASV,EAASF,QAClBa,YAAazB,GAAG,mEAGhBoB,UAAW,SACXC,UAAW,YACXC,MAAOtB,GAAG,aACVwB,QAAS,GACTC,YAAazB,GAAG,QAM5BgB,EAAOU,OAGPV,EAAOW,YAAYC,UAAUC,SAASjC,GAAG,QAAS,SAAUkC,GACxDC,QAAQC,IAAIhB,EAAOW,YAAYM,WAAWC,OAC1CzC,OAAOQ,MACHC,OAAQ,qBACRC,MACIgC,KAAMC,OACNC,QAASrB,EAAOW,YAAYM,WAAWC,MACvCI,QAASA,SAEb9B,SAAU,sBAQ3BK,SAAS,eAEZR,QAAQkC,KAAKC,gBAAgBxC,GAAG,qBAAsB,WAElDe,IAAIC,EAAS,IAAIvB,OAAOC,GAAGuB,QACvBC,MAAOlB,GAAG,oBACVmB,SAEQC,UAAW,SACXC,UAAW,eACXC,MAAOtB,GAAG,qBACVuB,MAAM,EACNC,SACI,qBACA,+BACA,oCAEJC,YAAazB,GAAG,uDAGhBoB,UAAW,SACXC,UAAW,cACXC,MAAOtB,GAAG,oBACVwB,QAAS,GACTC,YAAazB,GAAG,QAM5BgB,EAAOU,OAGPV,EAAOW,YAAYc,YAAYZ,SAASjC,GAAG,QAAS,SAAUkC,GAC1DC,QAAQC,IAAIhB,EAAOW,YAAYe,aAAaR"}